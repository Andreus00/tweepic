:: loading settings :: url = jar:file:/home/andrea/miniconda3/envs/tweepic/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Dataframe loaded
+--------------------+------------------+----+-----+---+--------------------+
|               label|                id|year|month|day|                text|
+--------------------+------------------+----+-----+---+--------------------+
|     2016-brexit.ids|720320595259428864|2016|    4| 13|@SuzanneEvans1: G...|
|2015-parisattacks...|666374429316747264|2015|   11| 16|oh my https://t.c...|
|2014-hongkong-pro...|521971201879855104|2014|   10| 14|@FrontLineHRD: Sa...|
|   2014-ferguson.ids|501619038897053696|2014|    8| 19|@AntonioFrench: W...|
|2015-nepalearthqu...|592659550693675008|2015|    4| 27|@upscinfo: Nepal ...|
|   2012-euro2012.ids|216257879706054657|2012|    6| 22|Just observed tha...|
|2015-nepalearthqu...|592339802420334592|2015|    4| 26|HF local teams #N...|
|2016-hijacked-pla...|714722885823283201|2016|    3| 29|@CNN: BREAKING: A...|
|2015-parisattacks...|665299776037089280|2015|   11| 13|@valenciacf: CLUB...|
|     2016-brexit.ids|720320595259428864|2016|    4| 13|@SuzanneEvans1: G...|
|2015-parisattacks...|666374429316747264|2015|   11| 16|oh my https://t.c...|
|2014-hongkong-pro...|521971201879855104|2014|   10| 14|@FrontLineHRD: Sa...|
|   2014-ferguson.ids|501619038897053696|2014|    8| 19|@AntonioFrench: W...|
|2015-nepalearthqu...|592659550693675008|2015|    4| 27|@upscinfo: Nepal ...|
|   2012-euro2012.ids|216257879706054657|2012|    6| 22|Just observed tha...|
|2015-nepalearthqu...|592339802420334592|2015|    4| 26|HF local teams #N...|
|2016-hijacked-pla...|714722885823283201|2016|    3| 29|@CNN: BREAKING: A...|
|2015-parisattacks...|665299776037089280|2015|   11| 13|@valenciacf: CLUB...|
|2012-hurricane-sa...|261856683775627266|2012|   10| 26|“@NBC12 Va. becom...|
|2012-hurricane-sa...|263361018003062784|2012|   10| 30|@Britpoptarts: Bu...|
+--------------------+------------------+----+-----+---+--------------------+
only showing top 20 rows

num rows: 4092
ld_wiki_tatoeba_cnn_21 download started this may take some time.
Approximate size to download 7,1 MB

[ | ]ld_wiki_tatoeba_cnn_21 download started this may take some time.
Approximate size to download 7,1 MB

[ / ]Download done! Loading the resource.

[OK!]
twitter_xlm_roberta_base download started this may take some time.
Approximate size to download 993,4 MB

[ | ]twitter_xlm_roberta_base download started this may take some time.
Approximate size to download 993,4 MB
Download done! Loading the resource.

[ / ]
[ — ]
[ \ ]
[ | ]
[ / ]
[ — ]
[OK!]
+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------+-------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+-----------+
|               label|                id|                text|            document|            language|            sentence|               token| hashtag_idxs|mentions_idxs|    punctuation_idxs|            hashtags|     word_embeddings| sentence_embeddings| hashtags_embeddings|date_embeddings|time_bucket|
+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------+-------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+-----------+
|     2016-brexit.ids|720320595259428864|@SuzanneEvans1: G...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 74...|[{token, 0, 13, @...|          [8]|       [0, 5]|     [1, 11, 15, 20]|           [#Brexit]|[[0.07663254, 0.1...|[0.02229748107492...|[[-0.11954531, 0....|         736067|         52|
|2015-parisattacks...|666374429316747264|          oh my http|[{document, 0, 9,...|[{language, 0, 9,...|[{document, 0, 9,...|[{token, 0, 1, oh...|           []|           []|                  []|                  []|[[0.03338991, 0.0...|[0.11942777037620...|                  []|         735918|         47|
|2014-hongkong-pro...|521971201879855104|@FrontLineHRD: Sa...|[{document, 0, 81...|[{language, 0, 81...|[{document, 0, 81...|[{token, 0, 12, @...|    [5, 6, 7]|          [0]|                 [1]|[#HongKongProtest...|[[-0.042789977, 0...|[0.01789403334259...|[[-0.031882588, 0...|         735520|         33|
|   2014-ferguson.ids|501619038897053696|@AntonioFrench: W...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 13...|[{token, 0, 13, @...|         [10]|          [0]|         [1, 12, 22]|         [#Ferguson]|[[-0.028335292, 0...|[-0.0059990375302...|[[-0.11596036, 0....|         735464|         32|
|2015-nepalearthqu...|592659550693675008|@upscinfo: Nepal ...|[{document, 0, 12...|[{language, 0, 12...|[{document, 0, 12...|[{token, 0, 8, @u...|           []|          [0]|              [1, 9]|                  []|[[0.010314881, 0....|[0.03003814071416...|                  []|         735715|         40|
|   2012-euro2012.ids|216257879706054657|Just observed tha...|[{document, 0, 79...|[{language, 0, 79...|[{document, 0, 44...|[{token, 0, 3, Ju...|         [11]|           []|                 [8]|[#SSFootball,#eur...|[[-0.115501806, 0...|[-0.0815939977765...|[[0.021411043, 0....|         734676|          5|
|2015-nepalearthqu...|592339802420334592|HF local teams #N...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 56...|[{token, 0, 1, HF...|[3, 4, 7, 22]|           []|     [8, 10, 16, 20]|[#Nepal, #India, ...|[[0.013301056, 0....|[-0.0784942731261...|[[-0.0815835, 0.0...|         735714|         40|
|2016-hijacked-pla...|714722885823283201|@CNN: BREAKING: A...|[{document, 0, 10...|[{language, 0, 10...|[{document, 0, 10...|[{token, 0, 3, @C...|           []|          [0]|           [1, 3, 8]|                  []|[[0.13282678, 0.2...|[-0.0185759793967...|                  []|         736052|         51|
|2015-parisattacks...|665299776037089280|@valenciacf: CLUB...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 13...|[{token, 0, 10, @...|           []|       [0, 5]|              [1, 3]|                  []|[[0.008889292, 0....|[-0.0592567883431...|                  []|         735915|         47|
|     2016-brexit.ids|720320595259428864|@SuzanneEvans1: G...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 74...|[{token, 0, 13, @...|          [8]|       [0, 5]|     [1, 11, 15, 20]|           [#Brexit]|[[0.07663254, 0.1...|[0.02229748107492...|[[-0.11954531, 0....|         736067|         52|
|2015-parisattacks...|666374429316747264|          oh my http|[{document, 0, 9,...|[{language, 0, 9,...|[{document, 0, 9,...|[{token, 0, 1, oh...|           []|           []|                  []|                  []|[[0.03338991, 0.0...|[0.11942777037620...|                  []|         735918|         47|
|2014-hongkong-pro...|521971201879855104|@FrontLineHRD: Sa...|[{document, 0, 81...|[{language, 0, 81...|[{document, 0, 81...|[{token, 0, 12, @...|    [5, 6, 7]|          [0]|                 [1]|[#HongKongProtest...|[[-0.042789977, 0...|[0.01789403334259...|[[-0.031882588, 0...|         735520|         33|
|   2014-ferguson.ids|501619038897053696|@AntonioFrench: W...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 13...|[{token, 0, 13, @...|         [10]|          [0]|         [1, 12, 22]|         [#Ferguson]|[[-0.028335292, 0...|[-0.0059990375302...|[[-0.11596036, 0....|         735464|         32|
|2015-nepalearthqu...|592659550693675008|@upscinfo: Nepal ...|[{document, 0, 12...|[{language, 0, 12...|[{document, 0, 12...|[{token, 0, 8, @u...|           []|          [0]|              [1, 9]|                  []|[[0.010314881, 0....|[0.03003814071416...|                  []|         735715|         40|
|   2012-euro2012.ids|216257879706054657|Just observed tha...|[{document, 0, 79...|[{language, 0, 79...|[{document, 0, 44...|[{token, 0, 3, Ju...|         [11]|           []|                 [8]|[#SSFootball,#eur...|[[-0.115501806, 0...|[-0.0815939977765...|[[0.021411043, 0....|         734676|          5|
|2015-nepalearthqu...|592339802420334592|HF local teams #N...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 56...|[{token, 0, 1, HF...|[3, 4, 7, 22]|           []|     [8, 10, 16, 20]|[#Nepal, #India, ...|[[0.013301056, 0....|[-0.0784942731261...|[[-0.0815835, 0.0...|         735714|         40|
|2016-hijacked-pla...|714722885823283201|@CNN: BREAKING: A...|[{document, 0, 10...|[{language, 0, 10...|[{document, 0, 10...|[{token, 0, 3, @C...|           []|          [0]|           [1, 3, 8]|                  []|[[0.13282678, 0.2...|[-0.0185759793967...|                  []|         736052|         51|
|2015-parisattacks...|665299776037089280|@valenciacf: CLUB...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 13...|[{token, 0, 10, @...|           []|       [0, 5]|              [1, 3]|                  []|[[0.008889292, 0....|[-0.0592567883431...|                  []|         735915|         47|
|2012-hurricane-sa...|261856683775627266|“@NBC12 Va. becom...|[{document, 0, 79...|[{language, 0, 79...|[{document, 0, 10...|[{token, 0, 6, “@...|         [13]|           []|                 [2]|            [#Sandy]|[[-0.10333124, -0...|[-0.0796541497111...|[[0.005887586, 0....|         734802|          9|
|2012-hurricane-sa...|263361018003062784|@Britpoptarts: Bu...|[{document, 0, 13...|[{language, 0, 13...|[{document, 0, 12...|[{token, 0, 12, @...|           []|          [0]|[1, 16, 19, 23, 2...|                  []|[[-4.7826924E-4, ...|[-0.0370780639350...|                  []|         734806|         10|
+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------------+-------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+-----------+
only showing top 20 rows

## SAVED ##



ho una tabella con all'interno un id e un numero che indica il bucket. Vorrei fare in modo che spark faccia un cross join solo tra gli elementi che fanno parte dello stesso bucket usando una window. come faccio? la tabella è come segue:
+------------------+-----------+
|                id|time_bucket|
+------------------+-----------+
|720320595259428864|         52|
|666374429316747264|         33|
|521971201879855104|         33|
|501619038897053696|         52|
+------------------+-----------+


il risultato dovrebbe essere del tipo:

+------------------+-----------+------------------+
|                id|time_bucket|               id2|
+------------------+-----------+------------------+
|720320595259428864|         52|501619038897053696|
|666374429316747264|         33|521971201879855104|
|521971201879855104|         33|666374429316747264|
|501619038897053696|         52|720320595259428864|
+------------------+-----------+------------------+

